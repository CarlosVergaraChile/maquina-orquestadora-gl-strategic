[pytest]
# Pytest Configuration for MÃ¡quina Orquestadora - Fast Testing Setup

# ============================================================================
# CORE TEST SETTINGS
# ============================================================================

# Test discovery patterns
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Test paths
testpaths = tests

# Minimum Python version
minversion = 7.0

# ============================================================================
# FAST TESTING OPTIMIZATIONS
# ============================================================================

# Run tests in parallel with pytest-xdist (auto-detect number of CPUs)
# Usage: pytest -n auto
addopts = 
    --strict-markers
    --tb=short
    --disable-warnings
    -ra
    --cache-clear

# Cache directory for faster subsequent runs
cache_dir = .pytest_cache

# ============================================================================
# MARKERS (Test Classification)
# ============================================================================

markers =
    unit: Unit tests (fast, <1s, no external dependencies)
    integration: Integration tests (slower, >1s, may call APIs)
    slow: Slow tests (very slow, API calls, external services)
    asyncio: Async tests
    smoke: Smoke tests (quick validation, fast feedback)

# ============================================================================
# COVERAGE SETTINGS
# ============================================================================

# Coverage options (if pytest-cov is installed)
[coverage:run]
branch = True
omit =
    */site-packages/*
    */venv/*
    setup.py

[coverage:report]
skip_covered = False
sort = Cover
precision = 2
threshold = 70
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:
    class .*\\bProtocol\\):
    @(abc\\.)?abstractmethod

# ============================================================================
# ASYNCIO SETTINGS
# ============================================================================

asyncio_mode = auto

# ============================================================================
# LOGGING
# ============================================================================

log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

log_file = test_results.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] %(name)s - %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# ============================================================================
# TIMEOUT SETTINGS (requires pytest-timeout)
# ============================================================================

timeout = 300
timeout_method = thread

# ============================================================================
# COMMAND PROFILES (Quick Reference)
# ============================================================================
# Fast unit tests only:
#   pytest -m unit -n auto
#
# All tests:
#   pytest
#
# With coverage:
#   pytest --cov=app --cov-report=html
#
# Verbose output:
#   pytest -v
#
# Failed tests only:
#   pytest --lf
#
# Watch mode (requires pytest-watch):
#   ptw -- -n auto
